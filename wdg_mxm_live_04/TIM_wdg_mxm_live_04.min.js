/*!
 *   TIM Developer: Israel Viveros
 *   Version: 1.1.5
 *   Copyright: Televisa Interactive Media (2014)
 */
(function(){$.fn.wdgMxmLive=function(b){var e=$.extend({idjornada:0,idmatch:0,title:""},b);
var c=this;var a=null;var d={urlFinal:"http://static-televisadeportes.esmas.com/sportsdata/futbol/data/"+e.idjornada+"/"+e.idmatch+"/match_mxm.js",callback:"datamxmvivo",tmpescuchaListener:0,inicio:function(){Maquetado='<div class="wdg_mxm_live_04_title textcolor-title1">'+e.title+"</div>";
Maquetado+='<div class="wdg_mxm_live_04_status">';Maquetado+='<ul class="wdg_mxm_live_04_list" id="pintaAcciones"></ul>';Maquetado+="</div>";Maquetado+='<div class="see_less textcolor-title4">Ocultar</div>';
c.html(Maquetado);d.loadMaster();d.listener=setInterval(function(){console.log("buscando etiqueta actualizable..");var g=$("#timeUpdateMxM");if(g.length){console.log("Antes: "+d.tmpescuchaListener);
console.log("Ahora: "+g.text());var f=parseInt(g.text());if(f>0&&parseInt(g.text())!==parseInt(d.tmpescuchaListener)){console.log("ACTUALIZANDO CON ... "+g.text());
d.tmpescuchaListener=parseInt(g.text());clearInterval(a);a=setInterval(function(){d.updateMxm();},f);}}},60000);},loadMaster:function(){var g=Math.floor((1+Math.random())*65536).toString(16);
var f="",h="";$.ajax({url:d.urlFinal,type:"GET",dataType:"jsonp",jsonpCallback:d.callback,cache:false}).done(function(p){for(var k=0;k<p.actionsMXM.length;
k++){var o="",r="";switch(p.actionsMXM[k].type.toLowerCase()){case"amonestacion":clase="tvsa-mxm-yellowcard";break;case"segundaamonestacion":clase="tvsa-mxm-secondyellowcard";
break;case"expulsion":clase="tvsa-mxm-redcard";break;case"fueradelugar":clase="tvsa-mxm-offside";break;case"tirodeesquina":clase="tvsa-mxm-cornerkick";
break;case"iniciaelpartido":clase="tvsa-mxm-startfirsthalf";break;case"iniciasegundotiempo":clase="tvsa-mxm-startsecondhalf";break;case"-":clase="tvsa-mxm-startovertime";
break;case"iniciaprimertiempoextra":clase="tvsa-mxm-startextrafirsthalf";break;case"iniciasegundotiempoextra":clase="tvsa-mxm-startextrasecondhalf";break;
case"--":clase="tvsa-mxm-penalties";break;case"finalizaelpartido":clase="tvsa-mxm-gameend";break;case"pegaenelposte":clase="tvsa-mxm-crossbar";break;case"pasaporafuera":clase="tvsa-mxm-out";
break;case"penal":clase="tvsa-mxm-penaltykick";break;case"atajada":clase="tvsa-mxm-block";break;case"autogollocal":clase="tvsa-mxm-owngoal";break;case"autogolvisitante":clase="tvsa-mxm-owngoal";
break;case"gollocal":clase="tvsa-mxm-goal";break;case"golvisitante":clase="tvsa-mxm-goal";break;case"golpenallocal":clase="tvsa-mxm-goal";break;case"golpenalvisitante":clase="tvsa-mxm-goal";
break;case"falta":clase="tvsa-mxm-foul";break;case"comentario":clase="tvsa-mxm-comment";break;case"datoestadistico":clase="tvsa-mxm-statisticdata";break;
case"entraaljuego":clase="tvsa-mxm-playerin";break;case"saledeljuego":clase="tvsa-mxm-playerout";break;case"suspenciontemporaljuego":clase="tvsa-mxm-suspended";
break;case"lesion":clase="tvsa-mxm-lesion";break;case"terminasegundotiempo":clase="tvsa-mxm-gameend";break;case"terminaprimertiempo":clase="tvsa-mxm-gameend";
break;case"twitter":clase="twitter";break;default:clase="tvsa-"+p.actionsMXM[k].type.toLowerCase();break;}f+='<li data-id="'+g+'" style="display:none">';
f+=(clase==="twitter")?'<div class="time-icon twitter">':'<div class="time-icon">';f+='<div class="textcolor-title6 time">'+p.actionsMXM[k].minute+"'</div>";
if(clase==="twitter"){f+='<div class="icon-time"><i class="tvsa-twitter"></i></div>';}else{f+='<div class="icon-time"><i class="'+clase+'"></i></div>';
}f+="</div>";f+=(clase!=="twitter")?'<div class="chronic"><span>'+p.actionsMXM[k].description+"</span></div>":"";if(clase==="twitter"){var q=p.actionsMXM[k].description.replace(",","|");
var n=q.split("|");var m=n[0].split("@");f+='<div class="chronic">';f+='<p class="textcolor-title2">'+m[0]+'<span class="textcolor-title4">@'+m[1]+"</span></p>";
f+="<p>"+n[1]+"</p></div>";}if(typeof p.actionsMXM[k].datarelated!=="undefined"){for(var j=0;j<p.actionsMXM[k].datarelated.length;j++){if(p.actionsMXM[k].datarelated[j].type.toLowerCase()==="galeria"){r+='<div class="img_stage_01 not_here" style="display: none;">';
r+='<div class="img_stage_01_image"> <img src="'+p.actionsMXM[k].datarelated[j].url+'" > </div>';if(typeof p.actionsMXM[k].datarelated[j].imagenTitulo!=="undefined"&&typeof p.actionsMXM[k].datarelated[j].imagenDesc!=="undefined"){r+=(p.actionsMXM[k].datarelated[j].imagenDesc!=="")?'<a class="img_stage_01_whtbkg" href="#"><p class="img_stage_01_black">'+p.actionsMXM[k].datarelated[j].imagenTitulo+"</p>":"";
r+=(p.actionsMXM[k].datarelated[j].imagenTitulo!=="")?'<p class="img_stage_01_gray">'+p.actionsMXM[k].datarelated[j].imagenDesc+"</p></a>":"";r+="</div>";
}}if(p.actionsMXM[k].datarelated[j].type.toLowerCase()==="video"&&p.actionsMXM[k].datarelated[j].id!==0){o+='<div class="vid_player_01 not_here" style="display: none;">';
o+='<div class="vid_player_01_image">';o+='<iframe width="100%" height="100%" src="" data-id="'+p.actionsMXM[k].datarelated[j].id+'" ></iframe>';o+='<div class="theaterContainer">';
o+='<div class="theaterSideSpacer"></div>';o+='<div class="theaterContainerVideo">';o+='<div class="videoLink"></div>';o+='<div class="contenedor"></div>';
o+="</div>";o+='<div class="theaterSideSpacer"></div>';o+="</div>";o+='<div class="companionBanner"></div>';o+="</div>";o+="</div>";}}}f+=(o!=="")?'<div class="icon-interactive textcolor-title4"> <i class="tvsa-videocamera"></i><i class="tvsa-error not-displayed"></i> </div>':"";
f+=(r!=="")?'<div class="icon-interactive2 dotted-right textcolor-title4"> <i class="tvsa-camera"></i> </div>':"";f+=r+o;f+="</li>";}c.find("#pintaAcciones").html(f);
$("[data-id="+g+"]").fadeIn("slow");d.funciones();}).fail(function(){console.log("error");});},funciones:function(){c.find(".tvsa-camera").live("click",function(f){f.preventDefault();
var g=$(this).parent().siblings(".img_stage_01");if(!$(this).hasClass("active")){$(".tvsa-camera").removeClass("active textcolor-title1 tvsa-error");$(this).addClass("active textcolor-title1 tvsa-error");
$(".img_stage_01").slideUp("slow");g.slideDown("slow",function(){});}else{$(this).removeClass("active textcolor-title1 tvsa-error");g.slideUp("slow");}});
c.find(".tvsa-videocamera").live("click",function(h){h.preventDefault();var i=$(this).parent().siblings(".vid_player_01.not_here");var g,f;if(!$(this).hasClass("active")){$(".tvsa-videocamera").removeClass("active textcolor-title1 tvsa-error");
$(this).addClass("active textcolor-title1 tvsa-error");$(".vid_player_01.not_here").slideUp("slow").find("iframe").attr({src:""});i.slideDown("slow",function(){f=parseInt($(this).outerWidth()*9/16);
$(this).height(f);$(this).find(".vid_player_01_image").height(f);g=$(this).find("iframe");g.attr({src:"http://tv.televisadeportes.esmas.com/embed/embed_ampp.php?id="+g.data("id")+"&w="+$(this).outerWidth()+"&h="+f+""});
});}else{$(this).removeClass("active textcolor-title1 tvsa-error");i.slideUp("slow",function(){g=$(this).find("iframe");g.attr({src:""});});}});},updateMxm:function(){var f="",g="";
$.ajax({url:d.urlFinal,type:"GET",dataType:"jsonp",jsonpCallback:d.callback,cache:false}).done(function(n){var h=Math.floor((1+Math.random())*65536).toString(16),r=0,u=0;
r=parseInt(c.find("#pintaAcciones").children("li").length);u=parseInt(n.actionsMXM.length);if(u>r){var p=u-r;for(var o=0;o<p;o++){var j="",t="";switch(n.actionsMXM[o].type.toLowerCase()){case"amonestacion":clase="tvsa-mxm-yellowcard";
break;case"segundaamonestacion":clase="tvsa-mxm-secondyellowcard";break;case"expulsion":clase="tvsa-mxm-redcard";break;case"fueradelugar":clase="tvsa-mxm-offside";
break;case"tirodeesquina":clase="tvsa-mxm-cornerkick";break;case"iniciaelpartido":clase="tvsa-mxm-startfirsthalf";break;case"iniciasegundotiempo":clase="tvsa-mxm-startsecondhalf";
break;case"-":clase="tvsa-mxm-startovertime";break;case"iniciaprimertiempoextra":clase="tvsa-mxm-startextrafirsthalf";break;case"iniciasegundotiempoextra":clase="tvsa-mxm-startextrasecondhalf";
break;case"--":clase="tvsa-mxm-penalties";break;case"finalizaelpartido":clase="tvsa-mxm-gameend";break;case"pegaenelposte":clase="tvsa-mxm-crossbar";break;
case"pasaporafuera":clase="tvsa-mxm-out";break;case"penal":clase="tvsa-mxm-penaltykick";break;case"atajada":clase="tvsa-mxm-block";break;case"autogollocal":clase="tvsa-mxm-owngoal";
break;case"autogolvisitante":clase="tvsa-mxm-owngoal";break;case"gollocal":clase="tvsa-mxm-goal";break;case"golvisitante":clase="tvsa-mxm-goal";break;case"golpenallocal":clase="tvsa-mxm-goal";
break;case"golpenalvisitante":clase="tvsa-mxm-goal";break;case"falta":clase="tvsa-mxm-foul";break;case"comentario":clase="tvsa-mxm-comment";break;case"datoestadistico":clase="tvsa-mxm-statisticdata";
break;case"entraaljuego":clase="tvsa-mxm-playerin";break;case"saledeljuego":clase="tvsa-mxm-playerout";break;case"suspenciontemporaljuego":clase="tvsa-mxm-suspended";
break;case"lesion":clase="tvsa-mxm-lesion";break;case"terminasegundotiempo":clase="tvsa-mxm-gameend";break;case"terminaprimertiempo":clase="tvsa-mxm-gameend";
break;case"twitter":clase="twitter";break;default:clase="tvsa-"+n.actionsMXM[o].type.toLowerCase();break;}f+='<li data-id="'+h+'" style="display:none">';
f+=(clase==="twitter")?'<div class="time-icon twitter">':'<div class="time-icon">';f+='<div class="textcolor-title6 time">'+n.actionsMXM[o].minute+"'</div>";
if(clase==="twitter"){f+='<div class="icon-time"><i class="tvsa-'+clase+'"></i></div>';}else{f+='<div class="icon-time"><i class="'+clase+'"></i></div>';
}f+="</div>";f+=(clase!=="twitter")?'<div class="chronic"><span>'+n.actionsMXM[o].description+"</span></div>":"";if(clase==="twitter"){var q=n.actionsMXM[o].description.replace(",","|");
var k=q.split("|");var s=k[0].split("@");f+='<div class="chronic">';f+='<p class="textcolor-title2">'+s[0]+'<span class="textcolor-title4">@'+s[1]+"</span></p>";
f+="<p>"+k[1]+"</p></div>";}if(typeof n.actionsMXM[o].datarelated!=="undefined"){for(var m=0;m<n.actionsMXM[o].datarelated.length;m++){if(n.actionsMXM[o].datarelated[m].type.toLowerCase()==="galeria"){t+='<div class="img_stage_01 not_here" style="display: none;">';
t+='<div class="img_stage_01_image"> <img src="'+n.actionsMXM[o].datarelated[m].url+'"> </div>';if(typeof n.actionsMXM[o].datarelated[m].imagenTitulo!=="undefined"&&typeof n.actionsMXM[o].datarelated[m].imagenDesc!=="undefined"){t+=(n.actionsMXM[o].datarelated[m].imagenDesc!=="")?'<a class="img_stage_01_whtbkg" href="#"><p class="img_stage_01_black">'+n.actionsMXM[o].datarelated[m].imagenTitulo+"</p>":"";
t+=(n.actionsMXM[o].datarelated[m].imagenTitulo!=="")?'<p class="img_stage_01_gray">'+n.actionsMXM[o].datarelated[m].imagenDesc+"</p></a>":"";t+="</div>";
}}if(n.actionsMXM[o].datarelated[m].type.toLowerCase()==="video"&&n.actionsMXM[o].datarelated[m].id!==0){j+='<div class="vid_player_01 not_here" style="display: none;">';
j+='<div class="vid_player_01_image">';j+='<iframe width="100%" height="100%" src="" data-id="'+n.actionsMXM[o].datarelated[m].id+'" ></iframe>';j+='<div class="theaterContainer">';
j+='<div class="theaterSideSpacer"></div>';j+='<div class="theaterContainerVideo">';j+='<div class="videoLink"></div>';j+='<div class="contenedor"></div>';
j+="</div>";j+='<div class="theaterSideSpacer"></div>';j+="</div>";j+='<div class="companionBanner"></div>';j+="</div>";j+="</div>";}}}f+=(j!=="")?'<div class="icon-interactive textcolor-title4"> <i class="tvsa-videocamera"></i><i class="tvsa-error not-displayed"></i> </div>':"";
f+=(t!=="")?'<div class="icon-interactive2 dotted-right textcolor-title4"> <i class="tvsa-camera"></i> </div>':"";f+=t+j;f+="</li>";}c.find("#pintaAcciones").prepend(f);
$("li[data-id="+h+"]").slideDown("slow");}}).fail(function(){console.log("Error al actualizar: "+d.urlFinal);});}};(e.idjornada!==0&&e.idmatch!==0)?d.inicio():"";
};})(jQuery);