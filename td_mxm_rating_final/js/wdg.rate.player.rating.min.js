/*!
 *   TIM Developer: Israel Viveros
 *   Version: 1.0.0
 *   Copyright: Televisa Interactive Media (2014)
 */
(function(){$.fn.wdgMxMRating=function(b){var c=$.extend({idTorneo:0,idPartido:0,idEquipo:0,idEquipo2:0,title:"",},b);
var d=this;var a={feedclublocal:"http://static-televisadeportes.esmas.com/sportsdata/futbol/data/"+c.idTorneo+"/clubes/"+c.idEquipo+"/matchesclub.js",feedclubVisit:"http://static-televisadeportes.esmas.com/sportsdata/futbol/data/"+c.idTorneo+"/clubes/"+c.idEquipo2+"/matchesclub.js",callbackRating:"gameplayerdetail",callbackLineup:"datagame",callbackClub:"effectivenessByTeam",inicio:function(){console.log("metod inicio");
(c.idTorneo,c.idPartido)?a.maquetado():console.log("Error falta el Id match o el Id Tournament");},maquetado:function(){console.log("metod maquetado");
var e='<div class="wdg_rate_player_01" data-enhance="false">';e+='<div class="qualifies textcolor-title4">Elige a tu jugador y vota</div>';e+="<table>";
e+="<tr>";e+='<td class="header_team">';e+='<table class="head_table">';e+="<tr >";e+='<th><img alt="" src="http://placehold.it/32x32"></th>';e+='<th colspan="3" class="equipo"><p class="title_team textcolor-title1">Monterrey</p></th>';
e+='<th><p class="title_td textcolor-title4 dotted-right">TD</p></th>';e+='<th><p class="title_afision textcolor-title1">Afición</p></th>';e+="</tr>";e+='<tr class="dotted-right">';
e+='<th colspan="6" class="day_relative">';e+='<div class="jornada">';e+='<div class="wdg_lineup_01_dropdown drop1">';e+='<div class="wdg_lineup_01_dropdowncontent">';
e+='<p id="nameJornadaLocal"></p>';e+='<span class="sprite dropdown-gray"></span>';e+="</div>";e+='<div class="wdg_lineup_01_listcontainer">';e+='<ul class="wdg_lineup_01_dropdownlist" id="localTIMDrop"></ul>';
e+="</div>";e+="</div>";e+="</div>";e+='<div style="clear:both;"></div>';e+="</th>";e+="</tr>";e+="</table>        ";e+='<table class="dotted-right">';
e+="<thead></thead>";e+='<tbody id="LocalTIMTitular">';e+="</tbody>";e+="</table>";e+="</td>";e+='<td class="header_team_ext">';e+='<table class="head_table2">';
e+="<tr>";e+='<th><img alt="" src="http://placehold.it/32x32"></th>';e+='<th colspan="2"><p class="title_team textcolor-title1">Monterrey</p></th>';e+='<th><p class="title_td textcolor-title4 dotted-right">TD</p></th>';
e+='<th><p class="title_afision textcolor-title1">Afición</p></th>';e+="</tr>";e+="<tr>";e+='<td colspan="6" class="day_relative2">';e+='<div class="jornada">';
e+='<div class="wdg_lineup_012_dropdown drop2">';e+='<div class="wdg_lineup_012_dropdowncontent">';e+='<p id="nameJornadaVisit"></p>';e+='<span class="sprite dropdown-gray"></span>';
e+="</div>";e+='<div class="wdg_lineup_012_listcontainer">';e+='<ul class="wdg_lineup_012_dropdownlist" id="visitTIMDrop"></ul>  ';e+="</div>";e+="</div>";
e+="</div>";e+='<div style="clear:both;"></div>';e+="</td>";e+="</tr>";e+="</table>  ";e+='<table class="header_team_2">';e+="<thead></thead>";e+='<tbody id="VisitTIMTitular">';
e+="</tbody>";e+="</table>";e+="</td>";e+="</tr>";e+='<tr class="textcolor-title1">';e+='<td colspan="3" class="reserves">Banca</td>';e+="</tr><tr>";e+='<td class="header_team dotted-right">';
e+="<table>";e+='<tbody id="LocalTIMBanca">';e+="</tbody>";e+="</table>";e+="</td>";e+='<td class="header_team_2 header_team_ext2">';e+='<table class="rate_team_2">';
e+='<tbody id="VisitTIMBanca">';e+="</tbody>";e+="</table>";e+="</td>";e+="</tr>";e+="</table>";e+='<div class="errorrating" style="display:none">Aun no existe informacion, para este partido</div>';
e+="</div>";d.html(e);a.loadPlayers(c.idPartido);a.loadDrops();},givemePosition:function(f){var e="";switch(f){case"F":return"Defensa";break;case"GK":return"Portero";
break;case"D":return"Defensa";break;case"MF":return"Medio Campo";break;case"F":return"Delantero";break;}},loadPlayers:function(e){console.log("metod loadPlayers");
$.ajax({url:"http://static-televisadeportes.esmas.com/sportsdata/futbol/data/"+c.idTorneo+"/"+e+"/match_lineup.js",type:"GET",dataType:"jsonp",jsonpCallback:a.callbackLineup}).done(function(k){var m="";
if(typeof(k.lineupLocal.team)!=="undefined"&&typeof(k.lineupLocal.team)!=="undefined"){for(var h=0;h<k.lineupLocal.team.length;h++){var g=k.lineupLocal.team[h];
m+='<tr class="evaluation first_child" data-guid="'+g.guid+'"> ';m+="<td>";m+='<div class="conteiner_two">';m+='<div class="vote_block vote dotted-bottom">';
m+='<div class="player_name"><p>'+g.nickName+"</p></div>";m+='<div class="div"><p class="textcolor-title4 porcentajetd">&nbsp;&nbsp;</p></div> ';m+='<div class="afision"><p class="textcolor-title1 dotted-left porcentajeplayer">&nbsp;&nbsp;</p></div> ';
m+='<div class="position"><p class="textcolor-title4">'+a.givemePosition(g.position)+"</p></div>";m+="</div>";m+='<div class="calification  textcolor-title4">';
m+='<div><p class="voto5">5</p></div>';m+='<div><p class="voto6">6</p></div>';m+='<div><div class="qualifies">califica al jugador</div><p class="voto7">7</p></div>';
m+='<div><p class="voto8">8</p></div>';m+='<div><p class="voto9">9</p></div>';m+='<div><p class="voto10">10</p></div>';m+="</div>";m+='<div class="participated  textcolor-title4">';
m+='<div class="voted"><p>Gracias por votar</p></div>';m+='<div><div class="qualifies">califica al jugador</div></div>';m+='<div class="check"><i class="tvsa-like"></i></div>';
m+="</div>";m+="</div>";m+="</td>";m+="</tr>";}$("#LocalTIMTitular").html(m);m="";for(var l=0;l<k.lineupLocal.substitutes.length;l++){var g=k.lineupLocal.substitutes[l];
m+='<tr class="evaluation first_child" data-guid="'+g.guid+'"> ';m+="<td>";m+='<div class="conteiner_two">';m+='<div class="vote_block vote dotted-bottom">';
m+='<div class="player_name"><p>'+g.nickName+"</p></div>";m+='<div class="div"><p class="textcolor-title4 porcentajetd">&nbsp;&nbsp;</p></div> ';m+='<div class="afision"><p class="textcolor-title1 dotted-left porcentajeplayer">&nbsp;&nbsp;</p></div> ';
m+='<div class="position"><p class="textcolor-title4">'+a.givemePosition(g.position)+"</p></div>";m+="</div>";m+='<div class="calification  textcolor-title4">';
m+='<div><p class="voto5">5</p></div>';m+='<div><p class="voto6">6</p></div>';m+='<div><div class="qualifies">califica al jugador</div><p class="voto7">7</p></div>';
m+='<div><p class="voto8">8</p></div>';m+='<div><p class="voto9">9</p></div>';m+='<div><p class="voto10">10</p></div>';m+="</div>";m+='<div class="participated  textcolor-title4">';
m+='<div class="voted"><p>Gracias por votar</p></div>';m+='<div><div class="qualifies">califica al jugador</div></div>';m+='<div class="check"><i class="tvsa-like"></i></div>';
m+="</div>";m+="</div>";m+="</td>";m+="</tr>";}$("#LocalTIMBanca").html(m);m="";for(var f=0;f<k.lineupVisit.team.length;f++){var g=k.lineupVisit.team[f];
m+='<tr class="evaluation first_child" data-guid="'+g.guid+'"> ';m+="<td>";m+='<div class="conteiner_two">';m+='<div class="vote_block vote dotted-bottom">';
m+='<div class="player_name"><p>'+g.nickName+"</p></div>";m+='<div class="div"><p class="textcolor-title4 porcentajetd"></p></div> ';m+='<div class="afision"><p class="textcolor-title1 dotted-left porcentajeplayer">&nbsp;&nbsp;</p></div> ';
m+='<div class="position"><p class="textcolor-title4">'+a.givemePosition(g.position)+"</p></div>";m+="</div>";m+='<div class="calification  textcolor-title4">';
m+='<div><p class="voto5">5</p></div>';m+='<div><p class="voto6">6</p></div>';m+='<div><div class="qualifies">califica al jugador</div><p class="voto7">7</p></div>';
m+='<div><p class="voto8">8</p></div>';m+='<div><p class="voto9">9</p></div>';m+='<div><p class="voto10">10</p></div>';m+="</div>";m+='<div class="participated  textcolor-title4">';
m+='<div class="voted"><p>Gracias por votar</p></div>';m+='<div><div class="qualifies">califica al jugador</div></div>';m+='<div class="check"><i class="tvsa-like"></i></div>';
m+="</div>";m+="</div>";m+="</td>";m+="</tr>";}$("#VisitTIMTitular").html(m);m="";for(var j=0;j<k.lineupVisit.substitutes.length;j++){var g=k.lineupVisit.substitutes[j];
m+='<tr class="evaluation first_child" data-guid="'+g.guid+'"> ';m+="<td>";m+='<div class="conteiner_two">';m+='<div class="vote_block vote dotted-bottom">';
m+='<div class="player_name"><p>'+g.nickName+"</p></div>";m+='<div class="div"><p class="textcolor-title4 porcentajetd">&nbsp;&nbsp;</p></div> ';m+='<div class="afision"><p class="textcolor-title1 dotted-left porcentajeplayer">&nbsp;&nbsp;</p></div> ';
m+='<div class="position"><p class="textcolor-title4">'+a.givemePosition(g.position)+"</p></div>";m+="</div>";m+='<div class="calification  textcolor-title4">';
m+='<div><p class="voto5">5</p></div>';m+='<div><p class="voto6">6</p></div>';m+='<div><div class="qualifies">califica al jugador</div><p class="voto7">7</p></div>';
m+='<div><p class="voto8">8</p></div>';m+='<div><p class="voto9">9</p></div>';m+='<div><p class="voto10">10</p></div>';m+="</div>";m+='<div class="participated  textcolor-title4">';
m+='<div class="voted"><p>Gracias por votar</p></div>';m+='<div><div class="qualifies">califica al jugador</div></div>';m+='<div class="check"><i class="tvsa-like"></i></div>';
m+="</div>";m+="</div>";m+="</td>";m+="</tr>";}$("#VisitTIMBanca").html(m);a.loadfeedrating(e);a.funcionesNaat();}else{$(".errorRating").css("display","block");
}setTimeout(function(){if($("#visitTIMDrop li").length===0){console.log("quito a visit");$("#nameJornadaVisit").html(k.week).css("cursor","auto");}if($("#localTIMDrop li").length===0){console.log("quito a local");
$("#nameJornadaLocal").html(k.week).css("cursor","auto");}},500);}).fail(function(){console.log("error");});},loadfeedrating:function(e){console.log("metod loadfeedrating");
$.ajax({url:"http://static-televisadeportes.esmas.com/sportsdata/futbol/data/"+c.idTorneo+"/"+e+"/gameplayerdetailjsonp.js",type:"GET",dataType:"jsonp",jsonpCallback:"gameplayerdetail",cache:false}).done(function(j){for(var h=0;
h<j.poll.length;h++){if(typeof(j.poll[h].answers)!=="undefined"&&typeof(j.poll[h].answers.answer[0])!=="undefined"){var g=j.poll[h].answers.answer[0];var f=$('tr[data-guid="'+g.value+'"]');
f.attr({"data-guidpoll":g.guid_poll,"data-guidsection":g.guid_section,"data-guidfield":g.guid_field});f.find(".voto5").attr("data-guidfvl",g.guid_resp[0].guid_fvl);
f.find(".voto6").attr("data-guidfvl",g.guid_resp[1].guid_fvl);f.find(".voto7").attr("data-guidfvl",g.guid_resp[2].guid_fvl);f.find(".voto8").attr("data-guidfvl",g.guid_resp[3].guid_fvl);
f.find(".voto9").attr("data-guidfvl",g.guid_resp[4].guid_fvl);f.find(".voto10").attr("data-guidfvl",g.guid_resp[5].guid_fvl);f.find(".porcentajeplayer").html(g.percent);
}}$(".wdg_lineup_012_listcontainer ul li, .wdg_lineup_01_listcontainer ul li").unbind("click").bind("click",function(i){console.log("este ID"+$(this).data("id"));
a.loadPlayers($(this).data("id"));});d.find(".voto5, .voto6, .voto7, .voto8, .voto9, .voto10").unbind("click").bind("click",function(i){i.preventDefault();
console.log("haz votado");});}).fail(function(){console.log("error");});},loadDrops:function(){console.log("metod loadDrops");$.ajax({url:a.feedclublocal,type:"GET",dataType:"jsonp",jsonpCallback:a.callbackClub,cache:false}).done(function(g){var h="";
for(var f=0;f<g.efectividad.length;f++){var e=g.efectividad[f];h+='<li data-id="'+e.matchid+'"><p>'+e.weekName+"</p></li>";}$("#localTIMDrop").html(h);
$("#nameJornadaLocal").html(g.efectividad[g.efectividad.length-1].weekName);}).fail(function(){console.log("error");});setTimeout(function(){$.ajax({url:a.feedclubVisit,type:"GET",dataType:"jsonp",jsonpCallback:a.callbackClub,cache:false}).done(function(f){var g="";
for(var h=0;h<f.efectividad.length;h++){var e=f.efectividad[h];g+='<li data-id="'+e.matchid+'"><p>'+e.weekName+"</p></li>";}$("#visitTIMDrop").html(g);
$("#nameJornadaVisit").html(f.efectividad[f.efectividad.length-1].weekName);}).fail(function(){console.log("error");});},500);$(".wdg_lineup_012_listcontainer ul, .wdg_lineup_01_listcontainer ul").css("height","0px");
},funcionesNaat:function(){console.log("metod funcionesNaat");if($(window).width()<948){$(".wdg_rate_player_01 .vote_block").on("touchstart",function(o){$(this).next("div").toggle();
o.preventDefault(o);});}$(".wdg_rate_player_01 .vote_block").click(function(){$(this).next("div").show();$(this).next().find("div").css("border-top","0");
$(".participated").delay(5000).fadeOut("slow");});$(".wdg_rate_player_01 .calification div").mouseenter(function(){$(this).children("p").removeClass("textcolor-title1");
$(this).children("p").addClass("textcolor-title1");}).mouseleave(function(){$(this).children("p").removeClass("textcolor-title4");$(this).children("p").addClass("textcolor-title4");
});$(".wdg_rate_player_01 .calification div").on("click",function(){$(this).parents(".calification").prev(".calification").remove();$(this).parents(".calification").next(".participated").find("div").css("border-bottom","1px solid #ccc");
$(this).parents(".calification").next().show();$(this).parents(".calification").remove();$(".wdg_rate_player_01 .last_child div").css("border-bottom","0");
$(".participated").delay(5000).fadeOut("slow");});$(".wdg_rate_player_01 .conteiner_two").mouseleave(function(){$(".wdg_rate_player_01 .calification").hide();
});$(".wdg_rate_player_01 .calification").mouseleave(function(){$(this).hide();$(this).prev("tr").prev(".vote").show();$(this).prev("tr").show();});if(!$.browser.opera){$(".wdg_rate_player_01 select.team1").each(function(){var o=$(this).attr("title");
if($.browser.msie&&$.browser.version<9){}else{if($("option:selected",this).val()!=""){o=$("option:selected",this).text();}$(this).css({"z-index":10,opacity:0,"-khtml-appearance":"none"}).after('<span class="select1">'+o+"</span>").change(function(){val=$("option:selected",this).text();
$(this).next().text(val);});}});$(".wdg_rate_player_01 select.team2").each(function(){var o=$(this).attr("title");if($.browser.msie&&$.browser.version<9){}else{if($("option:selected",this).val()!=""){o=$("option:selected",this).text();
}$(this).css({"z-index":10,opacity:0,"-khtml-appearance":"none"}).after('<span class="select2">'+o+"</span>").change(function(){val=$("option:selected",this).text();
$(this).next().text(val);});}});}var k=$(".wdg_rate_player_01");var i=k.find(".wdg_lineup_01_dropdown");var j=$(".wdg_lineup_01_dropdownlist li:first-child");
var h=k.find(".wdg_lineup_01_dropdownlist li");var f=$(".wdg_lineup_01_dropdownlist");i.unbind("click").bind("click",function(r){r.preventDefault();var q=$(this).children(".wdg_lineup_01_listcontainer").children(".wdg_lineup_01_dropdownlist:first-child");
var p=q.css("visibility");var o=q.children("li").length;visibilidadChild=$(this).children(f);if(p=="hidden"&&o>0){q.css({visibility:"visible",height:"176px","overflow-y":"scroll","overflow-x":"hidden"});
}else{q.css({visibility:"hidden",height:"0px"});}});i.bind("mouseleave",function(p){p.preventDefault();var q=$(this).find(".wdg_lineup_01_dropdownlist");
var o=q.css("visibility");if(o=="visible"){q.css({visibility:"hidden",height:"0px"});}});h.unbind("click").bind("click",function(o){o.preventDefault();
$(this).parents(".wdg_rate_player_01").find(".wdg_lineup_01_dropdowncontent p").html($(this).find("p").html());});var e=$(".wdg_rate_player_01");var l=e.find(".drop2");
var m=$(".wdg_lineup_012_dropdownlist li:first-child");var g=e.find(".wdg_lineup_012_dropdownlist li");var n=$(".wdg_lineup_012_dropdownlist");l.unbind("click").bind("click",function(q){q.preventDefault();
var o=$(this).children(".wdg_lineup_012_listcontainer").children().css("visibility");var r=n.children("li").length;var p=$(this).children(".wdg_lineup_012_listcontainer").children();
if(o=="hidden"&&r>0){p.css({visibility:"visible",height:"176px","overflow-y":"scroll","overflow-x":"hidden"});}else{p.css({visibility:"hidden",height:"0px"});
}});l.bind("mouseleave",function(p){p.preventDefault();var q=$(this).find(".wdg_lineup_012_dropdownlist");var o=q.css("visibility");if(o=="visible"){q.css({visibility:"hidden",height:"0px"});
}});g.unbind("click").bind("click",function(o){o.preventDefault();e.find(".wdg_lineup_012_dropdowncontent p").html($(this).find("p").html());});}};a.inicio();
};})(jQuery);