/*!
 *   TIM Developer: Israel Viveros
 *   Version: 1.3.0
 *   Copyright: Televisa Interactive Media (2014)
 */
(function(){$.fn.WdgSportResult=function(b){var c=$.extend({idtorneo:0,idteam:0,tema:"deportes"},b);
var a=this;var d=null;var e={urlFinalHeader:"http://static-televisadeportes.esmas.com/sportsdata/futbol/data/"+c.idtorneo+"/"+c.idteam+"/match_header.js",IdPestanasMenu:$("#TIMnav_smnu_sports"),tmpescuchaListener:0,loadInfo:function(f){$.ajax({url:e.urlFinalHeader,type:"GET",dataType:"jsonp",jsonpCallback:"mxmheader",cache:false,async:false}).done(function(g){(f==="update")?e.updateGoles(g):e.drawHeader(g);
}).fail(function(g){console.log("Error al cargar: "+e.urlFinalHeader);console.log(g);});},drawHeader:function(g){var f="",h=(parseInt(g.minuto)!==0)?g.minuto+"'":"";
f+='<div class="wrapper"><div class="match_title">';f+='<span class="hidden" id="datosTIMHeader"> <span id="timeUpdateMxM">0</span> <span id="localAbrevTIM" class="hidden">'+g.equipoLocal.abrev+'</span> <span id="visitAbrevTIM" class="hidden">'+g.equipoVisitante.abrev+'</span> <span id="localImgTIM" class="hidden">'+g.equipoLocal.smallImage+'</span> <span id="visitImgTIM" class="hidden">'+g.equipoVisitante.smallImage+'</span> <span id="localGolesTIM" class="hidden">'+g.equipoVisitante.goles+'</span> <span id="visitGolesTIM" class="hidden">'+g.equipoVisitante.goles+"</span>  </span>";
f+='<div class="cup_name">';f+=(g.transmisionVivo!=="")?'<div class="live-container textcolor-title3 background-color2 hidden" id="TIMVivoHeader" onclick="javascript:window.open(\''+g.transmisionVivo+'\');" style="cursor:pointer"><div class="icon-video"><i class="tvsa-videocamera"></i></div><div class="see-now">VER AHORA</div><div class="online">EN VIVO</div></div>':"";
f+='<div class="titulo textcolor-title3">'+g.torneo.nombre+"</div>";f+='<div class="subtitulo textcolor-title2">'+g.jornada.nombre+"</div>";f+="</div>";
f+="</div>";f+='<div class="live_time textcolor-title3 background-color1"><span>'+g.tiempo.replace(/'/g,"'")+" "+h+"</span></div>";f+='<div class="leftside">';
f+=(c.tema==="mundial")?'<div class="padre">':"";f+='<div class="team1">';f+='<div class="escudo"><img src="'+g.equipoLocal.lineupImage+'" alt="'+g.equipoLocal.nombre+'" width="48" height="48"></div>';
f+='<div class="equipo"><span>'+g.equipoLocal.nombre+"</span></div>";f+='<div class="score">'+g.equipoLocal.goles+"</div>";f+=(g.equipoLocal.penales===""||parseInt(g.equipoLocal.penales)===0)?'<div class="penales" style="visibility:hidden"><span class="penal"></span> PENALES</div>':'<div class="penales"><span class="penal">'+g.equipoLocal.penales+"</span> PENALES</div>";
f+="</div>";f+='<div class="dotted_separator"></div>';f+='<div class="team2">';f+=(g.equipoVisitante.penales===""||parseInt(g.equipoVisitante.penales)===0)?'<div class="penales" style="visibility:hidden"><span class="penal"></span> PENALES</div>':'<div class="penales"><span class="penal">'+g.equipoVisitante.penales+"</span> PENALES</div>";
f+='<div class="score">'+g.equipoVisitante.goles+"</div>";f+='<div class="equipo"><span>'+g.equipoVisitante.nombre+"</span></div>";f+='<div class="escudo"><img src="'+g.equipoVisitante.lineupImage+'" width="48" height="48" alt="'+g.equipoVisitante.nombre+'"></div>';
f+="</div>";f+='<div class="team2_m">';f+=(g.equipoVisitante.lineupImage!=="")?'<div class="escudo"><img src="'+g.equipoVisitante.lineupImage+'" width="48" height="48" alt="'+g.equipoVisitante.nombre+'"></div>':"";
f+='<div class="equipo"><span>'+g.equipoVisitante.nombre+"</span></div>";f+='<div class="score">'+g.equipoVisitante.goles+"</div>";f+=(g.equipoVisitante.penales===""||parseInt(g.equipoVisitante.penales)===0)?'<div class="penales" style="visibility:hidden"><span class="penal"></span> PENALES</div>':'<div class="penales"><span class="penal">'+g.equipoVisitante.penales+"</span> PENALES</div>";
f+="</div>";f+=(c.tema!=="mundial")?'<div class="solid_separator"></div>':"";f+='<div class="match_info">';f+=(typeof g.partidoIda!=="undefined")?'<div class="ida">Partido ida: <span class="blanco">'+g.partidoIda.local+" "+g.partidoIda.golesLocal+" - "+g.partidoIda.golesVisitante+" "+g.partidoIda.visitante+"</span></div>":"";
if(parseInt(g.equipoLocal.golesGlobal)!==0||parseInt(g.equipoVisitante.golesGlobal)!==0){f+='<div class="scoreglobal">Global: <span class="blanco">'+g.equipoLocal.nombre+' <span id="globalLoc">'+g.equipoLocal.golesGlobal+'</span> - <span id="globalVi">'+g.equipoVisitante.golesGlobal+"</span> "+g.equipoVisitante.nombre+"</span></div>";
}f+="</div>";f+="</div>";f+=(c.tema==="mundial")?'<div class="solid_separator"></div></div>':"";f+='<div class="date_venue">';f+='<div class="when">'+g.fechaPartidoLetra.replace(/-/g," ")+" <span>"+g.horaPartido+"</span></div>";
f+=(typeof g.estadio!=="undefined")?'<div class="where">Estadio '+g.estadio.nombre+"<br>"+g.estadio.ciudad+", "+g.estadio.pais+"</div>":"";f+=(typeof g.datocurioso!=="undefined")?'<div class="info">'+g.datocurioso+"</div>":"";
f+="</div>";f+="</div>";a.css("display","none").html(f).slideDown("slow",function(){$(this).css({display:"block"});});if(g.tiempo.toLowerCase()!=="final"){setTimeout(function(){e.timeUpdate(g.fechaPartido,g.horaPartido);
},300);setInterval(function(){e.timeUpdate(g.fechaPartido,g.horaPartido);},60000);}(typeof g.paginas!=="undefined"&&e.IdPestanasMenu.length)?e.drawMenu(g.paginas):e.IdPestanasMenu.hide();
},updateGoles:function(k){var h="",h="",i="",m="",n="",r="",u="",j="",f="",l="",g="",t="",s="",q="",p="",o=(parseInt(k.minuto)!==0)?k.minuto+"'":"";var h=String(k.equipoLocal.goles),i=String(k.equipoVisitante.goles),m=String(k.equipoLocal.penales),n=String(k.equipoVisitante.penales),l=String(k.tiempo)+" "+String(o),p=String(k.equipoLocal.golesGlobal),s=String(k.equipoVisitante.golesGlobal);
r=$(".team1 .score").text(),u=$(".team2 .score").text(),j=$(".team1 .penal").text(),f=$(".team2 .penal").text(),g=$(".live_time").text(),q=$("#globalLoc").text(),t=$("#globalVi").text();
(h!==String(r))?e.nuevoValor($(".team1 .score"),h):"";(i!==String(u))?e.nuevoValor($(".team2 .score, .team2_m .score"),i):"";(j!==String(m)&&parseInt(m)>0)?e.nuevoValor($(".team1 .penal"),m):"";
(f!==String(n)&&parseInt(n)>0)?e.nuevoValor($(".team2 .penal,.team2_m .penal"),n):"";(l!==String(g))?e.nuevoValor($(".live_time span"),l):"";(p!==String(q))?e.nuevoValor($("#globalLoc"),p):"";
(s!==String(t))?e.nuevoValor($("#globalVi"),s):"";},nuevoValor:function(f,g){f.parent(".penales").css("visibility","visible");f.fadeOut("slow",function(){$(this).empty();
$(this).text(g).slideDown("fast");});},timeUpdate:function(j,g){console.log("Metod -> timeUpdate");var f=$("#TIMVivoHeader");var h=0;var i="20"+j.substring(8,10)+"/"+j.substring(3,5)+"/"+j.substring(0,2)+" "+g.substring(0,5)+":00";
$.ajax({url:"http://mxm.televisadeportes.esmas.com/deportes/home/timetvjsonp.js",async:false,cache:false,dataType:"jsonp",jsonpCallback:"timetv",success:function(r){var t="",o=0,n=0,z=a.find(".live_time").text().toLowerCase().trim();
if(z==="previo"){a.find(".score").css("visibility","hidden");}else{a.find(".score").css("visibility","visible");}horas=r.timetv;t=r.fechatv.replace(/_/gi,"-").split("-");
o=parseInt(t[1])+1;if(String(o).length===1){o="0"+o;}n=parseInt(t[2])+1900;fechas=n+"/"+o+"/"+t[0];fechas=fechas+" "+horas+":00";var y=new Date(i);var x=new Date(fechas);
var s=Date.UTC(y.getFullYear(),y.getMonth()+1,y.getDate());var q=Date.UTC(x.getFullYear(),x.getMonth()+1,x.getDate());if(parseFloat(s)<parseFloat(q)){console.log("Fecha Menor(YA PASO EL PARTIDO)");
}else{if(parseFloat(s)===parseFloat(q)){console.log("Dia del Evento");var v=y.getTime(),l=x.getTime(),k=9000000,u=3600000,w=v+k,A=v-u,p=v-l;console.log("Hora Servidor: "+new Date(l));
console.log("Hora Partido: "+new Date(v));console.log("Hora Previo partido: "+new Date(A));console.log("Hora Fin partido: "+new Date(w));if(v<=l&&l<=w){console.log("El patido esta en vivo");
if(f.length){f.removeClass("hidden");}h=20000;}else{console.log(p);if(parseInt(p)<u&&parseInt(p)>0){console.log("Estamos a menos de 60 min del partido");
h=20000;}}}else{if(parseFloat(s)>parseFloat(q)){console.log("Fecha Mayor (AUN NO PASA EL PARTIDO)");}else{console.log("Error no actualizo");}}}if(h===0){h=(z!=="final"&&z!=="previo")?20000:0;
}console.log("Tiempo de actualizacion: "+h);clearInterval(d);if(h!==0){d=setInterval(function(){e.tmpescuchaListener=parseInt($("#timeUpdateMxM").text());
e.loadInfo("update");},h);}$("#timeUpdateMxM").text(h);}});},drawMenu:function(j){var i="";i+='<div class="navarrowleft">';i+='<a class="wdg_matchesresult_navleft" href="#left"> ';
i+='<span class="navlefticon"><i class="tvsa-double-caret-left inactive"></i></span></a></div>';i+='<div class="container">';i+='<div class="nav_smnu_sports_01_bar"><ul>';
i+=(typeof j.previo!=="undefined"&&j.previo!=="")?'<li class="previoMenuTim"> <a href="'+j.previo+'" target="_parent">Previo</a></li>':"";i+=(typeof j.alineacion!=="undefined"&&j.alineacion!=="")?'<li class="nav_smnu_sports_01_block alineacionMenuTim"><a href="'+j.alineacion+'" target="_parent" title="Alineaci\u00F3n">Alineaci\u00F3n</a></li>':"";
i+=(typeof j.rating!=="undefined"&&j.rating!==""&&c.tema!=="mundial")?'<li class="hide1 ratingMenuTim"><a href="'+j.rating+'" title="Rating">Rating</a></li>':"";
i+=(typeof j.mxm!=="undefined"&&j.mxm!=="")?'<li class="nav_smnu_sports_01_block nav_smnu_sports_01_block2 mxmMenuTim"><a href="'+j.mxm+'" target="_parent" title="MxM">MxM</a></li>':"";
i+=(typeof j.pizarra!=="undefined"&&j.pizarra!==""&&c.tema!=="mundial")?'<li class="hide2 pizarraMenuTim"><a href="'+j.pizarra+'" title="Pizarra">Pizarra</a></li>':"";
i+=(typeof j.cronica!=="undefined"&&j.cronica!=="")?'<li class="nav_smnu_sports_01_block nav_smnu_sports_01_block2 cronicaMenuTim"><a href="'+j.cronica+'" target="_parent" title="Cr\u00F3nica">Cr\u00F3nica</a></li>':"";
i+=(typeof j.video!=="undefined"&&j.video!=="")?'<li class="last nav_smnu_sports_01_block videoMenuTim"><a href="'+j.video+'" title="Video" target="_parent">Video</a></li>':"";
i+=(parseInt(c.idteam)===25521||parseInt(c.idteam)===25395||parseInt(c.idteam)===25487||parseInt(c.idteam)===25488)?'<li class="last nav_smnu_sports_01_block camara360"><a href="camara360.html" title="camara" target="_parent">C\u00E1mara 360</a></li>':"";
i+=(c.tema==="mundial")?'<li class="last nav_smnu_sports_01_block interaMenuTim"><a href="interacciontd.html" title="interacci\u00F3n TD" target="_parent">Interacci\u00F3n TD</a></li>':"";
i+="</ul></div></div>";i+='<div class="navarrowright"><a class="wdg_matchesresult_navright" href="#right">';i+='<span class="navrighticon"><i class="tvsa-double-caret-right active"></i></span></a></div>';
e.IdPestanasMenu.html(i).show();var h=document.URL;(/previo.html/.test(h))?$(".previoMenuTim").addClass("current"):"";(/previo_m.html/.test(h))?$(".previoMenuTim").addClass("current"):"";
(/alineacion.html/.test(h))?$(".alineacionMenuTim").addClass("current"):"";(/alineacion_m.html/.test(h))?$(".alineacionMenuTim").addClass("current"):"";
(/rating.html/.test(h))?$(".ratingMenuTim").addClass("current"):"";(/mxm.html/.test(h))?$(".mxmMenuTim").addClass("current"):"";(/mxm_m.html/.test(h))?$(".mxmMenuTim").addClass("current"):"";
(/pizarra.html/.test(h))?$(".pizarraMenuTim").addClass("current"):"";(/cronica.html/.test(h))?$(".cronicaMenuTim").addClass("current"):"";(/cronica_m.html/.test(h))?$(".cronicaMenuTim").addClass("current"):"";
(/video.html/.test(h))?$(".videoMenuTim").addClass("current"):"";(/interacciontd.html/.test(h))?$(".interaMenuTim").addClass("current"):"";(/camara360.html/.test(h))?$(".camara360").addClass("current"):"";
if(c.tema==="mundial"){var g=[25521,25395,25487,25488];for(var f=0;f<g.length;f++){if(parseInt(c.idteam)===g[f]){$(".interaMenuTim").css("display","none");
}}}}};if(c.idtorneo!==0&&c.idteam!==0){setTimeout(function(){e.loadInfo();},300);}else{(console.log("---->Faltan los Id's de team y/o torneo"));}};})(jQuery);
